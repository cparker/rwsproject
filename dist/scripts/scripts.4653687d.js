var mockFixtureLines=[{$$hashKey:"object:69",channels:{channel_count:1,id:3},controlMethod:{id:3,name:"Sensor 3"},controlQuantity:"3",distribution:{id:3,name:"Direct"},emergencyQuantity:"2",fixtureId:"1",fixtureLineId:0,fixtureSize:{id:21,name:"600mm x 600mm"},fixtureType:{id:3,name:"Troffer"},lumens:{id:5,lumens:"1600"},manufacturer:{id:10,name:"NoviLED"},mountType:{id:6,name:"Recessed"},partInfo:{desc_id:12,description:"Alfa Modular 2x2 33W",model:"AM 0606 xx-xx-700",model_id:3,part_id:39,part_number:"SEN-3M1-W-NOVI3370"},projectId:"2014-09-30 04:39:28 PM",selectedAccessories:[],sensorType:{id:2,name:"Normal"},standardQuantity:"1"},{$$hashKey:"object:71",channels:{channel_count:1,id:3},controlMethod:{id:3,name:"Sensor 3"},controlQuantity:"4",distribution:{id:3,name:"Direct"},emergencyQuantity:"3",fixtureId:"2",fixtureLineId:1,fixtureSize:{id:20,name:'6"'},fixtureType:{id:2,name:"Downlight"},lumens:{id:2,lumens:"1100"},manufacturer:{id:12,name:"Richter"},mountType:{id:2,name:"Wall"},partInfo:{desc_id:60,description:'Richter Lumio 6" downlight',model:'HL-DL-12W-6"-xx-RW1C',model_id:18,part_id:41,part_number:"SEN-3M1-W-RTDL1350"},projectId:"2014-09-30 04:39:28 PM",selectedAccessories:[],sensorType:{id:2,name:"Normal"},standardQuantity:"2"},{$$hashKey:"object:73",channels:{channel_count:1,id:3},controlMethod:{id:3,name:"Sensor 3"},controlQuantity:"3",distribution:{id:3,name:"Direct"},emergencyQuantity:"3",fixtureId:"3",fixtureLineId:2,fixtureSize:{id:28,name:"n/a"},fixtureType:{id:1,name:"Accent"},lumens:{id:4,lumens:"1470"},manufacturer:{id:12,name:"Richter"},mountType:{id:2,name:"Wall"},notes:"Notes are fun",partInfo:{desc_id:59,description:"Richter Camino S Pendant",model:"Camino S 17W xxxxK RW1CH",model_id:13,part_id:42,part_number:"SEN-3M1-W-RTPD1350"},projectId:"2014-09-30 04:39:28 PM",selectedAccessories:[{accessory:{$$hashKey:"object:15",description:"Universal Gateway Wiring Harness",part_number:"RG-2G-WH"},accessoryCount:5},{accessory:{$$hashKey:"object:19",description:"Sensor mounting box (open ceiling)",part_number:"ADAPTER-BOX-1G"},accessoryCount:5}],sensorType:{id:3,name:"Low"},standardQuantity:"3"},{$$hashKey:"object:75",channels:{channel_count:0,id:1},controlMethod:{id:4,name:"n/a"},controlQuantity:"1",distribution:{id:3,name:"Direct"},emergencyQuantity:"1",fixtureId:"4",fixtureLineId:3,fixtureSize:{id:2,name:"1200mm X 50mm"},fixtureType:{id:4,name:"Linear"},lumens:{id:10,lumens:"2800"},manufacturer:{id:4,name:"Hatec"},mountType:{id:3,name:"Surface"},notes:"Notes are fun yea!",partInfo:{desc_id:41,description:"K50-Square Recessed/Ceiling Mounted Linear fixture",model:"R201401005-13",model_id:47,part_id:44,part_number:"n/a"},projectId:"2014-09-30 04:39:28 PM",selectedAccessories:[{accessory:{$$hashKey:"object:20",description:"Sensor Mounting Bracket for ML 1x4 and 2x2",part_number:"ADP-MOUNT-W"},accessoryCount:5},{accessory:{$$hashKey:"object:23",description:"RJ45-18AWG Adapter (1 per CH)",part_number:"TRM-RJ45-EU"},accessoryCount:1},{accessory:{$$hashKey:"object:30",description:"1ch fixt-adp pigtail, 36 inch length",part_number:"PIGTAIL-1-FIXTURE"},accessoryCount:4}],sensorType:{id:1,name:"None"},standardQuantity:"1"}],mockFixtureLineSelectChoices=[{channels:[{channel_count:1,id:3}],controlMethods:[{id:3,name:"Sensor 3"}],distributions:[{id:3,name:"Direct"}],fixtureSizes:[{id:21,name:"600mm x 600mm"}],fixtureTypes:[{id:8,name:"AC Zones (Qty)"},{id:1,name:"Accent"},{id:7,name:"Desk Sensor"},{id:2,name:"Downlight"},{id:5,name:"Fixtureless"},{id:4,name:"Linear"},{id:6,name:"Occupancy"},{id:10,name:"Out of Scope"},{id:3,name:"Troffer"}],lumens:[{id:5,lumens:"1600"}],manufacturers:[{id:10,name:"NoviLED"}],mountTypes:[{id:6,name:"Recessed"},{id:3,name:"Surface"}],sensorTypes:[{id:1,name:"None"},{id:2,name:"Normal"},{id:3,name:"Low"},{id:4,name:"High"}]},{channels:[{channel_count:1,id:3}],controlMethods:[{id:3,name:"Sensor 3"}],distributions:[{id:3,name:"Direct"}],fixtureSizes:[{id:20,name:'6"'}],fixtureTypes:[{id:8,name:"AC Zones (Qty)"},{id:1,name:"Accent"},{id:7,name:"Desk Sensor"},{id:2,name:"Downlight"},{id:5,name:"Fixtureless"},{id:4,name:"Linear"},{id:6,name:"Occupancy"},{id:10,name:"Out of Scope"},{id:3,name:"Troffer"}],lumens:[{id:2,lumens:"1100"}],manufacturers:[{id:12,name:"Richter"}],mountTypes:[{id:2,name:"Wall"}],sensorTypes:[{id:1,name:"None"},{id:2,name:"Normal"},{id:3,name:"Low"},{id:4,name:"High"}]},{channels:[{channel_count:1,id:3}],controlMethods:[{id:3,name:"Sensor 3"}],distributions:[{id:3,name:"Direct"}],fixtureSizes:[{id:28,name:"n/a"}],fixtureTypes:[{id:8,name:"AC Zones (Qty)"},{id:1,name:"Accent"},{id:7,name:"Desk Sensor"},{id:2,name:"Downlight"},{id:5,name:"Fixtureless"},{id:4,name:"Linear"},{id:6,name:"Occupancy"},{id:10,name:"Out of Scope"},{id:3,name:"Troffer"}],lumens:[{id:4,lumens:"1470"}],manufacturers:[{id:12,name:"Richter"}],mountTypes:[{id:2,name:"Wall"}],sensorTypes:[{id:1,name:"None"},{id:2,name:"Normal"},{id:3,name:"Low"},{id:4,name:"High"}]},{channels:[{channel_count:0,id:1}],controlMethods:[{id:4,name:"n/a"}],distributions:[{id:3,name:"Direct"}],fixtureSizes:[{id:2,name:"1200mm X 50mm"},{id:3,name:"1300mm X 50mm"},{id:9,name:"2400 x 50mm"},{id:13,name:"3600 x 50mm"},{id:18,name:"5300mm x 50mm"},{id:26,name:"CUSTOM"}],fixtureTypes:[{id:8,name:"AC Zones (Qty)"},{id:1,name:"Accent"},{id:7,name:"Desk Sensor"},{id:2,name:"Downlight"},{id:5,name:"Fixtureless"},{id:4,name:"Linear"},{id:6,name:"Occupancy"},{id:10,name:"Out of Scope"},{id:3,name:"Troffer"}],lumens:[{id:10,lumens:"2800"}],manufacturers:[{id:4,name:"Hatec"}],mountTypes:[{id:6,name:"Recessed"},{id:3,name:"Surface"},{id:1,name:"Suspended"}],sensorTypes:[{id:1,name:"None"},{id:2,name:"Normal"},{id:3,name:"Low"},{id:4,name:"High"}]}],mockProjectInfo={address:"123 Elm St.\nLouisville, CO\n80027",basedOn:"CAD Drawing",createdBy:"Christian",dateTime:"2014-09-30 04:39:28 PM",email:"cp@cjparker.us",notes:"This is the best project evar!",projectName:"Test Project Alpha",region:{id:2,name:"EMEA"},region_id:2}(function(a){"use strict";function b(a,b){var h,i,j,k,l,m,n,o,p,q,r,s,t="",u=!1;if(isNaN(a))throw new Error("Invalid arguments");return b=b||{},j=b.bits===!0,o=b.unix===!0,i=void 0!==b.base?b.base:o?2:10,n=void 0!==b.round?b.round:o?1:2,p=void 0!==b.spacer?b.spacer:o?"":" ",s=void 0!==b.suffixes?b.suffixes:{},m=Number(a),l=0>m,k=i>2?1e3:1024,l&&(m=-m),0===m?o?t="0":(q="B",t="0"+p+(s[q]||q)):(h=Math.floor(Math.log(m)/Math.log(1e3)),h>8&&(t=1e3*t*(h-8),h=8),t=2===i?m/Math.pow(2,10*h):m/Math.pow(1e3,h),j&&(t=8*t,t>k&&(t/=k,h++)),t=t.toFixed(h>0?n:0),q=g[j?"bits":"bytes"][h],!u&&o?(j&&c.test(q)&&(q=q.toLowerCase()),q=q.charAt(0),r=t.replace(e,""),"B"===q?q="":j||"k"!==q||(q="K"),f.test(r)&&(t=parseInt(t,d)),t+=p+(s[q]||q)):o||(t+=p+(s[q]||q))),l&&(t="-"+t),t}var c=/b$/,d=10,e=/.*\./,f=/^0$/,g={bits:["B","kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","kB","MB","GB","TB","PB","EB","ZB","YB"]};"undefined"!=typeof exports?module.exports=b:"function"==typeof define?define(function(){return b}):a.filesize=b})(this),theApp=angular.module("rwsprojectApp",["angularFileUpload","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMockE2E"]);theApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/launcher.html",controller:"launcherCtrl"}).when("/home",{templateUrl:"views/home.html",controller:"HomeCtrl",reloadOnSearch:!1}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/files",{templateUrl:"views/files.html",controller:"filesCtrl",reloadOnSearch:!1}).when("/dirs",{templateUrl:"views/dirs.html",controller:"filesCtrl",reloadOnSearch:!1}).when("/#tab:*/",{reloadOnSearch:!1}).when("/printSummary",{templateUrl:"views/printSummary.html",controller:"printSummaryCtrl"}).otherwise({redirectTo:"/"})}]),theApp.run(["$httpBackend","dataService",function(a,b){console.log("theApp is initializing");var c=!1;1==c?(console.log("MOCK DATA in effect"),b.fixtureLines=mockFixtureLines,b.fixtureLineSelectChoices=mockFixtureLineSelectChoices,a.whenGET("/server/checkAccess").respond(200,{}),a.whenGET("/server/getProjectInfo").respond(mockProjectInfo),a.whenGET(/.*\.html/).passThrough(),a.whenGET(/^\/server.*/).passThrough(),a.whenDELETE(/.*/).passThrough()):(a.whenGET(/.*/).passThrough(),a.whenPOST(/.*/).passThrough(),a.whenPUT(/.*/).passThrough(),a.whenDELETE(/.*/).passThrough())}]),angular.module("rwsprojectApp").factory("dataService",["$http",function(a){var b={selectedFixtureLine:void 0,fixtureLines:[],fixtureLineSelectChoices:[],addFixtureLine:function(a,b,c,d,e){a.fixtureLineId=this.fixtureLines.length,a.selectedAccessories=b,a.projectId=c,a.notes=e,this.fixtureLines.push(a),this.fixtureLineSelectChoices[a.fixtureLineId]=JSON.parse(JSON.stringify(d)),this.selectedFixtureLine=a.fixtureLineId,this.submitFixtureLine(a)},getFixtureLines:function(){return this.fixtureLines},deleteFixtureLine:function(a){for(var b=void 0,c=0;c<this.fixtureLines.length;c++)a===this.fixtureLines[c][this.fixtureLineId];this.fixtureLines.splice(b,1)},selectFixtureLine:function(a){this.selectedFixtureLine=a;var b=_.find(this.fixtureLines,function(b){return b.fixtureLineId===a});return[b,this.fixtureLineSelectChoices[a]]},isLineSelected:function(a){return this.selectedFixtureLine===a},submitProjectInfo:function(b){return a({method:"POST",url:"/server/submitProjectInfo",data:b})},fetchProjectInfo:function(){return a({method:"GET",url:"/server/getProjectInfo"})},fetchRegions:function(){return a.get("/server/regions")},fetchFixtureTypes:function(b){return a.get("/server/getFixtureTypes?regionId="+b)},fetchMountTypes:function(b,c){return a.get("/server/getMountTypes?regionId="+b+"&fixtureTypeId="+c)},fetchFixtureSizes:function(b,c,d){return a.get("/server/getFixtureSizes?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d)},fetchDistributions:function(b,c,d,e){return a.get("/server/getDistributions?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d+"&fixtureSizeId="+e)},fetchLumens:function(b,c,d,e,f){return a.get("/server/getLumens?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d+"&fixtureSizeId="+e+"&distributionId="+f)},fetchChannels:function(b,c,d,e,f,g){return a.get("/server/getChannels?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d+"&fixtureSizeId="+e+"&distributionId="+f+"&lumensId="+g)},fetchManufacturers:function(b,c,d,e,f,g,h){return a.get("/server/getManufacturers?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d+"&fixtureSizeId="+e+"&distributionId="+f+"&lumensId="+g+"&channelsId="+h)},fetchControlMethods:function(b,c,d,e,f,g,h,i){return a.get("/server/getControlMethods?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d+"&fixtureSizeId="+e+"&distributionId="+f+"&lumensId="+g+"&channelsId="+h+"&manufacturerId="+i)},getPartInfo:function(b,c,d,e,f,g,h,i,j){return a.get("/server/getPartInfo?regionId="+b+"&fixtureTypeId="+c+"&mountTypeId="+d+"&fixtureSizeId="+e+"&distributionId="+f+"&lumensId="+g+"&channelsId="+h+"&manufacturerId="+i+"&controlMethodId="+j)},fetchAccessories:function(){return a.get("/server/getAccessories")},submitFixtureLine:function(b){return a({method:"POST",url:"/server/submitFixture",data:b})},getFiles:function(b){return a.get(b?"/server/getFiles?dir="+b:"/server/getFiles")},checkAccess:function(){return a.get("/server/checkAccess")},doLogin:function(b,c){var d={username:b,password:c};return a({method:"POST",url:"/server/login",data:d})},deleteFile:function(b){var c={url:b.url};return a({method:"DELETE",url:"/server/deleteFile",data:b,params:c})}};return b}]),angular.module("rwsprojectApp").controller("MainCtrl",["$scope","$http","$rootScope","dataService",function(a,b,c,d){console.log("main controller is being instantiated"),a.user={},d.checkAccess().success(function(){c.isLoggedIn=!0,a.$emit("loggedInChanged",!0)}).error(function(){c.isLoggedIn=!1,a.$emit("loggedInChanged",!1)}),a.doLogin=function(){d.doLogin(a.user.name,a.user.password).success(function(){c.isLoggedIn=!0,a.invalidCredentials=!1,a.$emit("loggedInChanged",!0)}).error(function(b){a.invalidCredentials=!0,a.$emit("loggedInChanged",!1),console.log(b)})},c.errorMessage=void 0,c.$on("error",function(a,b){console.log("RS received event "+a+" error "+b),c.errorMessage=b}),c.logit=function(a){console.log(a)},c.dismissError=function(){c.errorMessage=void 0}}]),angular.module("rwsprojectApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("rwsprojectApp").controller("HomeCtrl",["$scope",function(){}]),angular.module("rwsprojectApp").controller("printSummaryCtrl",["$scope","$filter","$rootScope","dataService",function(){}]),angular.module("rwsprojectApp").controller("filesCtrl",["$scope","FileUploader","dataService","$route","$rootScope",function(a,b,c,d,e){console.log("current params"),console.log(d),a.baseUploadURL="/server/uploadFile",a.fileData={files:[],dirs:[]},a.filesize=filesize;var f=function(b){c.getFiles(b).success(function(b){a.fileData.files=[],a.fileData.dirs=[],_.each(b.payload.files,function(b){a.fileData.files.push(b)})}).error(function(a){console.log(a)})};a.selectDir=function(a){console.log("dirUrl is "+a.url),f(a)},a.uploader=new b,a.uploader.url=a.baseUploadURL,a.uploader.removeAfterUpload=!0,a.uploader.onWhenAddingFileFailed=function(a,b,c){console.info("onWhenAddingFileFailed",a,b,c)},a.uploader.onAfterAddingFile=function(a){console.info("onAfterAddingFile",a)},a.uploader.onAfterAddingAll=function(a){console.info("onAfterAddingAll",a)},a.uploader.onBeforeUploadItem=function(a){console.info("onBeforeUploadItem",a)},a.uploader.onProgressItem=function(a,b){console.info("onProgressItem",a,b)},a.uploader.onProgressAll=function(a){console.info("onProgressAll",a)},a.uploader.onSuccessItem=function(a,b,c,d){console.info("onSuccessItem",a,b,c,d)},a.uploader.onErrorItem=function(a,b,c,d){console.info("onErrorItem",a,b,c,d)},a.uploader.onCancelItem=function(a,b,c,d){console.info("onCancelItem",a,b,c,d)},a.uploader.onCompleteItem=function(a,b,c,d){console.info("onCompleteItem",a,b,c,d)},a.uploader.onCompleteAll=function(){console.info("onCompleteAll"),f(d.current.params.dir)},d.current.params.dir&&(a.selectedDir=d.current.params.dir,a.uploader.url=a.baseUploadURL+"?dir="+d.current.params.dir,f(d.current.params.dir)),a.toggleFileDeleteDialog=function(b){a.highlightedFile=b?b.name:void 0,a.fileToDelete=b,a.isFileDeleteDialogActive=!a.isFileDeleteDialogActive},a.confirmDelete=function(){c.deleteFile(a.fileToDelete).success(function(){f(d.current.params.dir),a.isFileDeleteDialogActive=!1}).error(function(b){e.emit("error",b),a.isFileDeleteDialogActive=!1})},a.isFileHighlighted=function(b){return a.highlightedFile===b}}]),angular.module("rwsprojectApp").controller("launcherCtrl",["$scope","FileUploader","dataService","$route","$rootScope","$httpBackend",function(){}]),angular.module("rwsprojectApp").controller("projectInfoFormController",["$scope","$filter","$rootScope","dataService","$httpBackend",function(a,b,c,d){a.regions=[{name:"EMEA",id:1},{name:"APAC",id:2}],c.tabs.tabOne={dateTime:b("date")(new Date,"yyyy-MM-dd hh:mm:ss a"),projectName:void 0,address:void 0,region:{name:"EMEA",id:2},createdBy:void 0,basedOn:void 0,email:void 0,notes:void 0,region_id:2},d.fetchRegions().success(function(b){a.regions=b.payload}).error(function(){a.$emit("error retrieving regions")}),d.fetchProjectInfo().success(function(a){console.log("received project info"),console.log(a),c.tabs.tabOne=a,console.log(c.tabs.tabOne)}).error(function(){console.log("no active project")}),c.$on("tabLosingFocus",function(b,e,f){"tab1"===e?a.projectInfo.$valid?(d.submitProjectInfo(c.tabs.tabOne),c.tabs.activeTab=f):a.projectInfo.$setSubmitted():c.tabs.activeTab=f})}]),angular.module("rwsprojectApp").controller("fixtureFormController",["$scope","$filter","$rootScope","dataService",function(a,b,c,d){c.dropDownChoices={fixtureTypes:[{name:"FIXTURE ONE",id:1},{name:"FIXTURE TWO",id:2}],mountTypes:[{name:"MOUNT ONE",id:1},{name:"MOUNT TWO",id:2}],fixtureSizes:[{name:"SIZE ONE",id:1},{name:"SIZE TWO",id:2}],distributions:[{name:"dist1",id:1},{name:"dist2",id:2}],lumens:[{name:"100",id:1},{name:"200",id:2}],channels:[{name:"1",id:1},{name:"2",id:2}],manufacturers:[{name:"m1",id:1},{name:"m2",id:2}],controlMethods:[{name:"c1",id:1},{name:"c2",id:2}],sensorTypes:[{name:"None",id:1},{name:"Normal",id:2},{name:"Low",id:3},{name:"High",id:4}]},c.fixtureForm={},a.setFixtureTypesBySelectedRegion=function(){c.dropDownChoices.sensorTypes=[{name:"None",id:1},{name:"Normal",id:2},{name:"Low",id:3},{name:"High",id:4}],d.fetchFixtureTypes(c.tabs.tabOne.region.id).success(function(a){c.dropDownChoices.fixtureTypes=a.payload}).error(function(a){console.log(a)})},c.$on("tabLosingFocus",function(b,c,d){"tab2"===d&&a.setFixtureTypesBySelectedRegion()}),a.changeFixtureType=function(){d.fetchMountTypes(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id).success(function(a){c.dropDownChoices.mountTypes=a.payload}).error(function(a){console.log(a)})},a.changeMountType=function(){d.fetchFixtureSizes(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id).success(function(a){c.dropDownChoices.fixtureSizes=a.payload}).error(function(a){console.log(a)})},a.changeFixtureSize=function(){d.fetchDistributions(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id,c.fixtureForm.fixtureSize.id).success(function(a){c.dropDownChoices.distributions=a.payload}).error(function(a){console.log(a)})},a.changeDistribution=function(){d.fetchLumens(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id,c.fixtureForm.fixtureSize.id,c.fixtureForm.distribution.id).success(function(a){c.dropDownChoices.lumens=a.payload}).error(function(a){console.log(a)})},a.changeLumens=function(){d.fetchChannels(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id,c.fixtureForm.fixtureSize.id,c.fixtureForm.distribution.id,c.fixtureForm.lumens.id).success(function(a){c.dropDownChoices.channels=a.payload}).error(function(a){console.log(a)})},a.changeChannels=function(){d.fetchManufacturers(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id,c.fixtureForm.fixtureSize.id,c.fixtureForm.distribution.id,c.fixtureForm.lumens.id,c.fixtureForm.channels.id).success(function(a){c.dropDownChoices.manufacturers=a.payload}).error(function(a){console.log(a)})},a.changeManufacturers=function(){d.fetchControlMethods(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id,c.fixtureForm.fixtureSize.id,c.fixtureForm.distribution.id,c.fixtureForm.lumens.id,c.fixtureForm.channels.id,c.fixtureForm.manufacturer.id).success(function(a){c.dropDownChoices.controlMethods=a.payload}).error(function(a){console.log(a)})},a.changeControlMethod=function(){d.getPartInfo(c.tabs.tabOne.region.id,c.fixtureForm.fixtureType.id,c.fixtureForm.mountType.id,c.fixtureForm.fixtureSize.id,c.fixtureForm.distribution.id,c.fixtureForm.lumens.id,c.fixtureForm.channels.id,c.fixtureForm.manufacturer.id,c.fixtureForm.controlMethod.id).success(function(a){c.fixtureForm.partInfo=a.payload[0]}).error(function(a){console.log(a)})},a.addFixtureLine=function(){a.fixtureTabForm.$setSubmitted();var b=_.map(c.selectedAccessories,function(b,c){return{accessoryCount:b,accessory:a.accessories[c]}}),e=_.filter(b,function(a){return void 0!=a.accessoryCount});a.fixtureTabForm.$valid&&d.addFixtureLine(c.fixtureForm,e,c.tabs.tabOne.dateTime,c.dropDownChoices,c.copiedFixtureNotes)},a.resetFixtureForm=function(){c.fixtureForm={},c.dropDownChoices={},a.setFixtureTypesBySelectedRegion(),c.fixtureNotes="",a.fixtureTabForm.$setPristine(),d.selectedFixtureLine=void 0,c.selectedAccessories=[]},a.hasLineBeenAdded=function(){return void 0!=a.fixtureForm.fixtureLineId}}]),angular.module("rwsprojectApp").controller("tabController",["$scope","$rootScope","$route","$http","$filter","dataService",function(a,b,c,d,e,f){b.isLoggedIn=void 0,a.invalidCredentials=!1,a.user={},b.tabs={},b.tabs.activeTab="tab1",a.selectedLineId=void 0,b.tabs.accessoriesDialogHide=!0,b.tabs.notesDialogHide=!0,a.regions=[],a.selectedRegion=0,a.accessories=[],b.selectedAccessories=[],b.fixtureNotes="these are notes",a.activeSummarySection="menu",f.fetchAccessories().success(function(b){a.accessories=b.payload}).error(function(b){a.$emit("httpError","Failed to fetch accessories "+b)}),a.deleteFixtureLine=function(a){f.deleteFixtureLine(a)},a.fixtureLineSelect=function(a){var c=f.selectFixtureLine(a.fixtureLineId);b.dropDownChoices=c[1],b.fixtureForm=c[0]},a.isLineSelected=function(a){return f.isLineSelected(a.fixtureLineId)},a.tabs.tabClick=function(b){a.$emit("tabLosingFocus",a.tabs.activeTab,b)},a.tabs.isTabActive=function(b){return b==a.tabs.activeTab},a.tabs.toggleAccessoriesDialog=function(){a.tabs.accessoriesDialogHide=0==a.tabs.accessoriesDialogHide},a.tabs.toggleNotesDialog=function(){b.copiedFixtureNotes=a.fixtureNotes,a.tabs.notesDialogHide=0==a.tabs.notesDialogHide},d.get("/server/checkAccess").success(function(){console.log("we are logged in"),b.isLoggedIn=!0,a.$emit("loggedInChanged",!0)}).error(function(){console.log("we are not logged in"),b.isLoggedIn=!0,a.$emit("loggedInChanged",!1)}),b.tempToggleLogin=function(){b.isLoggedIn=!b.isLoggedIn},a.getFixtureLines=function(){return f.getFixtureLines()},a.tabClass=function(a,c,d){return d==b.tabs.activeTab?a:c},a.selectSummary=function(b){a.activeSummarySection=b},a.selectEmergencyRadio=function(b){a.selectedEmergencyRadio=b},a.testBroadcast=function(b,c){console.log("emiting event "+b+" "+c),a.$emit(b,c)}}]);